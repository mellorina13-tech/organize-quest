            // Google login buttons
            document.getElementById('googleLoginBtn').addEventListener('click', async function() {
                const { data<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organize.Quest - Discover & Create Local Organizations</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%235865F2'/><stop offset='100%25' style='stop-color:%234ECDC4'/></linearGradient></defs><circle cx='50' cy='50' r='45' fill='url(%23grad)'/><path d='M50 20 L65 40 L85 40 L70 55 L75 75 L50 60 L25 75 L30 55 L15 40 L35 40 Z' fill='white'/></svg>">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #5865F2;
            --primary-dark: #4752C4;
            --secondary: #FF6B6B;
            --accent: #4ECDC4;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            overflow-x: hidden;
        }

        .language-bar {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            padding: 0.5rem 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1001;
        }

        .language-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 1rem;
        }

        .lang-switcher {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .lang-btn {
            background: rgba(88, 101, 242, 0.1);
            color: var(--dark);
            border: 2px solid rgba(88, 101, 242, 0.2);
            padding: 0.4rem 0.6rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .lang-btn:hover {
            background: rgba(88, 101, 242, 0.15);
            transform: translateY(-1px);
        }

        .lang-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(88, 101, 242, 0.3);
        }

        .landing-page {
            display: block;
        }

        .landing-page.hidden {
            display: none;
        }

        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            z-index: 1000;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            color: var(--gray);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn-login {
            background: transparent;
            color: var(--primary);
            padding: 0.6rem 1.5rem;
            border: 2px solid var(--primary);
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            cursor: pointer;
        }

        .btn-login:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(88, 101, 242, 0.3);
        }

        .btn-nav {
            background: var(--primary);
            color: white;
            padding: 0.6rem 1.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            cursor: pointer;
        }

        .btn-nav:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(88, 101, 242, 0.3);
        }

        .hero {
            padding: 8rem 2rem 4rem;
            min-height: 90vh;
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            color: white;
            line-height: 1.2;
        }

        .hero-content p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn-primary {
            background: white;
            color: var(--primary);
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            padding: 1rem 2.5rem;
            border: 2px solid white;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn-secondary:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-3px);
        }

        .hero-visual {
            position: relative;
        }

        .phone-mockup {
            width: 100%;
            max-width: 400px;
            height: 500px;
            background: white;
            border-radius: 30px;
            padding: 20px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            margin: 0 auto;
        }

        .mockup-map {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            border-radius: 15px;
            position: relative;
        }

        .map-pin {
            position: absolute;
            width: 30px;
            height: 30px;
            background: var(--secondary);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
        }

        .map-pin:nth-child(1) { top: 30%; left: 40%; }
        .map-pin:nth-child(2) { top: 50%; left: 60%; background: var(--accent); }
        .map-pin:nth-child(3) { top: 70%; left: 30%; background: var(--primary); }

        .features {
            padding: 5rem 2rem;
            background: var(--light);
        }

        .features-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .features-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .features-header h2 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .features-header p {
            font-size: 1.2rem;
            color: var(--gray);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .map-app {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: white;
            z-index: 2000;
        }

        .map-app.active {
            display: block;
        }

        .map-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            padding: 1rem 2rem;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .map-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            height: 100vh;
            padding-top: 70px;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-sidebar {
            background: var(--light);
            padding: 2rem;
            overflow-y: auto;
        }

        .map-btn {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
        }

        .map-btn-primary {
            background: var(--primary);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
        }

        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            .hero-container {
                grid-template-columns: 1fr;
            }
            .hero-visual {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="landing-page" id="landingPage">
        <nav>
            <div class="nav-container">
                <div class="logo">🌐 <span id="logoText">Organize.Quest</span></div>
                <div class="nav-links">
                    <a href="#features" class="nav-link" id="navFeatures">Features</a>
                    <a href="#" class="nav-link" id="navAbout">About</a>
                </div>
                <div class="nav-buttons">
                    <div class="lang-switcher">
                        <button class="lang-btn active" id="btnEN">🇬🇧</button>
                        <button class="lang-btn" id="btnTR">🇹🇷</button>
                    </div>
                    <button class="btn-login" id="loginBtn">Log In</button>
                    <button class="btn-nav" id="openMapBtn">Open Map</button>
                </div>
            </div>
        </nav>

        <section class="hero">
            <div class="hero-container">
                <div class="hero-content">
                    <h1 id="heroTitle">Build Your Local Community Network</h1>
                    <p id="heroDesc">Create, discover, and join organizations in your neighborhood.</p>
                    <div class="hero-buttons">
                        <button class="btn-primary" id="heroMapBtn">Start Exploring</button>
                        <a href="#features" class="btn-secondary">Learn More</a>
                    </div>
                </div>
                <div class="hero-visual">
                    <div class="phone-mockup">
                        <div class="mockup-map">
                            <div class="map-pin"></div>
                            <div class="map-pin"></div>
                            <div class="map-pin"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="features" id="features">
            <div class="features-container">
                <div class="features-header">
                    <h2 id="featuresTitle">Everything You Need to Connect</h2>
                    <p id="featuresDesc">Powerful features to help you build communities</p>
                </div>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">📍</div>
                        <h3>Location Discovery</h3>
                        <p>Find organizations near you</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🚀</div>
                        <h3>Easy Creation</h3>
                        <p>Create your organization in minutes</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🏷️</div>
                        <h3>Smart Categories</h3>
                        <p>Browse by category</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div class="map-app" id="mapApp">
        <div class="map-header">
            <h2>🌐 <span id="mapTitle">Organize.Quest Map</span></h2>
            <button class="btn-primary" id="closeMapBtn">← Back</button>
        </div>
        <div class="map-container">
            <div id="map"></div>
            <div class="map-sidebar">
                <button class="map-btn map-btn-primary" id="findLocationBtn">📍 Find My Location</button>
                <button class="map-btn map-btn-primary" id="createOrgBtn">➕ Create Organization</button>
                <div id="orgList"></div>
            </div>
        </div>
    </div>

    <div id="createModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="modalCloseBtn">&times;</span>
            <h2 id="modalTitle">Create Organization</h2>
            <form id="createOrgForm">
                <div class="form-group">
                    <label id="orgNameLabel">Organization Name *</label>
                    <input type="text" id="orgName" required placeholder="Enter organization name">
                </div>
                <div class="form-group">
                    <label id="orgCategoryLabel">Category *</label>
                    <select id="orgCategory" required>
                        <option value="">Select</option>
                        <option value="Education">🎓 Education</option>
                        <option value="Healthcare">🏥 Healthcare</option>
                        <option value="Technology">💻 Technology</option>
                        <option value="Non-Profit">🤝 Non-Profit</option>
                        <option value="Sports">⚽ Sports</option>
                        <option value="Arts">🎨 Arts</option>
                        <option value="Community">🏘️ Community</option>
                    </select>
                </div>
                <div class="form-group">
                    <label id="orgDescLabel">Description</label>
                    <textarea id="orgDescription" placeholder="Describe your organization"></textarea>
                </div>
                <div class="form-group">
                    <label id="orgDateLabel">Event Date & Time</label>
                    <input type="datetime-local" id="orgDateTime">
                </div>
                <div class="form-group">
                    <label id="orgAgeLabel">Age Restriction</label>
                    <select id="orgAgeRestriction">
                        <option value="all">All Ages</option>
                        <option value="18+">18+ Only</option>
                        <option value="21+">21+ Only</option>
                        <option value="13+">13+ Only</option>
                        <option value="kids">Kids (Under 13)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label id="orgCapacityLabel">Maximum Participants</label>
                    <input type="number" id="orgCapacity" min="1" placeholder="e.g., 50">
                </div>
                <div class="form-group">
                    <label id="orgContactLabel">Contact Email</label>
                    <input type="email" id="orgContact" placeholder="contact@organization.com">
                </div>
                <div class="form-group">
                    <label id="orgLocationLabel">Location on Map *</label>
                    <input type="text" id="orgLocationDisplay" readonly placeholder="Click on map to select location" style="background: #f0f0f0; cursor: not-allowed;">
                </div>
                <button type="submit" class="map-btn map-btn-primary" id="createOrgSubmit">Create Organization</button>
            </form>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="loginModalClose">&times;</span>
            <h2 id="loginModalTitle">Welcome to Organize.Quest</h2>
            
            <div id="loginTabButtons" style="display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid #e0e0e0;">
                <button class="tab-btn active" id="loginTabBtn" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 3px solid var(--primary); font-weight: 600; color: var(--primary); cursor: pointer;">
                    <span id="loginTabText">Sign In</span>
                </button>
                <button class="tab-btn" id="signupTabBtn" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 3px solid transparent; font-weight: 600; color: var(--gray); cursor: pointer;">
                    <span id="signupTabText">Sign Up</span>
                </button>
            </div>

            <form id="loginForm" style="display: block;">
                <button type="button" class="google-btn" id="googleLoginBtn" style="width: 100%; padding: 0.8rem; margin-bottom: 1.5rem; background: white; border: 2px solid #e0e0e0; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s ease;">
                    <svg width="20" height="20" viewBox="0 0 20 20">
                        <path fill="#4285F4" d="M19.6 10.2c0-.7-.1-1.4-.2-2H10v3.8h5.4c-.2 1.2-1 2.2-2 2.9v2.5h3.2c1.9-1.7 3-4.3 3-7.2z"/>
                        <path fill="#34A853" d="M10 20c2.7 0 4.9-.9 6.6-2.4l-3.2-2.5c-.9.6-2 1-3.4 1-2.6 0-4.8-1.8-5.6-4.1H1.1v2.6C2.8 17.9 6.1 20 10 20z"/>
                        <path fill="#FBBC05" d="M4.4 11.9c-.4-1.2-.4-2.6 0-3.8V5.5H1.1c-1.5 2.9-1.5 6.4 0 9.3l3.3-2.9z"/>
                        <path fill="#EA4335" d="M10 4c1.4 0 2.7.5 3.7 1.4l2.8-2.8C14.9 1 12.7 0 10 0 6.1 0 2.8 2.1 1.1 5.5l3.3 2.6C5.2 5.8 7.4 4 10 4z"/>
                    </svg>
                    <span id="googleBtnText">Continue with Google</span>
                </button>
                
                <div style="text-align: center; margin: 1.5rem 0; color: var(--gray); position: relative;">
                    <span style="background: white; padding: 0 1rem; position: relative; z-index: 1;" id="orText">or</span>
                    <div style="position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #e0e0e0; z-index: 0;"></div>
                </div>

                <div class="form-group">
                    <label id="loginEmailLabel">Email</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label id="loginPasswordLabel">Password</label>
                    <input type="password" id="loginPassword" required placeholder="••••••••">
                </div>
                <div class="form-group">
                    <a href="#" style="color: var(--primary); text-decoration: none; font-size: 0.9rem;" id="forgotPasswordLink">Forgot password?</a>
                </div>
                <button type="submit" class="map-btn map-btn-primary" id="loginSubmitBtn">Sign In</button>
            </form>

            <form id="signupForm" style="display: none;">
                <button type="button" class="google-btn" id="googleSignupBtn" style="width: 100%; padding: 0.8rem; margin-bottom: 1.5rem; background: white; border: 2px solid #e0e0e0; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s ease;">
                    <svg width="20" height="20" viewBox="0 0 20 20">
                        <path fill="#4285F4" d="M19.6 10.2c0-.7-.1-1.4-.2-2H10v3.8h5.4c-.2 1.2-1 2.2-2 2.9v2.5h3.2c1.9-1.7 3-4.3 3-7.2z"/>
                        <path fill="#34A853" d="M10 20c2.7 0 4.9-.9 6.6-2.4l-3.2-2.5c-.9.6-2 1-3.4 1-2.6 0-4.8-1.8-5.6-4.1H1.1v2.6C2.8 17.9 6.1 20 10 20z"/>
                        <path fill="#FBBC05" d="M4.4 11.9c-.4-1.2-.4-2.6 0-3.8V5.5H1.1c-1.5 2.9-1.5 6.4 0 9.3l3.3-2.9z"/>
                        <path fill="#EA4335" d="M10 4c1.4 0 2.7.5 3.7 1.4l2.8-2.8C14.9 1 12.7 0 10 0 6.1 0 2.8 2.1 1.1 5.5l3.3 2.6C5.2 5.8 7.4 4 10 4z"/>
                    </svg>
                    <span id="googleSignupBtnText">Sign up with Google</span>
                </button>

                <div style="text-align: center; margin: 1.5rem 0; color: var(--gray); position: relative;">
                    <span style="background: white; padding: 0 1rem; position: relative; z-index: 1;" id="orText2">or</span>
                    <div style="position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #e0e0e0; z-index: 0;"></div>
                </div>

                <div class="form-group">
                    <label id="signupNameLabel">Full Name</label>
                    <input type="text" id="signupName" required placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label id="signupEmailLabel">Email</label>
                    <input type="email" id="signupEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label id="signupPasswordLabel">Password</label>
                    <input type="password" id="signupPassword" required placeholder="••••••••" minlength="6">
                </div>
                <div class="form-group">
                    <label id="signupConfirmLabel">Confirm Password</label>
                    <input type="password" id="signupConfirm" required placeholder="••••••••" minlength="6">
                </div>
                <button type="submit" class="map-btn map-btn-primary" id="signupSubmitBtn">Create Account</button>
            </form>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://wsqhnoobklhvgzfnogap.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndzcWhub29ia2xodmd6Zm5vZ2FwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzcyNTAyNDYsImV4cCI6MjA1MjgyNjI0Nn0.aMHsyKeqmCgQUfW8TYoTa7aR5CsOnIaFa4bPlE_sxRE';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const translations = {
            en: {
                logoText: 'Organize.Quest',
                navFeatures: 'Features',
                navAbout: 'About',
                loginBtn: 'Log In',
                openMapBtn: 'Open Map',
                heroTitle: 'Build Your Local Community Network',
                heroDesc: 'Create, discover, and join organizations in your neighborhood.',
                featuresTitle: 'Everything You Need to Connect',
                featuresDesc: 'Powerful features to help you build communities',
                mapTitle: 'Organize.Quest Map',
                modalTitle: 'Create Organization',
                orgNameLabel: 'Organization Name *',
                orgCategoryLabel: 'Category *',
                orgDescLabel: 'Description',
                orgDateLabel: 'Event Date & Time',
                orgAgeLabel: 'Age Restriction',
                orgCapacityLabel: 'Maximum Participants',
                orgContactLabel: 'Contact Email',
                orgLocationLabel: 'Location on Map *',
                createOrgSubmit: 'Create Organization',
                loginModalTitle: 'Welcome to Organize.Quest',
                loginTabText: 'Sign In',
                signupTabText: 'Sign Up',
                loginEmailLabel: 'Email',
                loginPasswordLabel: 'Password',
                forgotPasswordLink: 'Forgot password?',
                loginSubmitBtn: 'Sign In',
                signupNameLabel: 'Full Name',
                signupEmailLabel: 'Email',
                signupPasswordLabel: 'Password',
                signupConfirmLabel: 'Confirm Password',
                signupSubmitBtn: 'Create Account',
                googleBtnText: 'Continue with Google',
                googleSignupBtnText: 'Sign up with Google',
                orText: 'or',
                orText2: 'or'
            },
            tr: {
                logoText: 'Organize.Quest',
                navFeatures: 'Özellikler',
                navAbout: 'Hakkında',
                loginBtn: 'Giriş Yap',
                openMapBtn: 'Haritayı Aç',
                heroTitle: 'Yerel Topluluk Ağınızı Kurun',
                heroDesc: 'Mahallenizdeki organizasyonları oluşturun, keşfedin ve katılın.',
                featuresTitle: 'Bağlanmak İçin Her Şey',
                featuresDesc: 'Toplulukları oluşturmanıza yardımcı olacak güçlü özellikler',
                mapTitle: 'Organize.Quest Harita',
                modalTitle: 'Organizasyon Oluştur',
                orgNameLabel: 'Organizasyon Adı *',
                orgCategoryLabel: 'Kategori *',
                orgDescLabel: 'Açıklama',
                orgDateLabel: 'Etkinlik Tarihi & Saati',
                orgAgeLabel: 'Yaş Kısıtlaması',
                orgCapacityLabel: 'Maksimum Katılımcı',
                orgContactLabel: 'İletişim E-postası',
                orgLocationLabel: 'Harita Üzerinde Konum *',
                createOrgSubmit: 'Organizasyon Oluştur',
                loginModalTitle: 'Organize.Quest\'e Hoş Geldiniz',
                loginTabText: 'Giriş Yap',
                signupTabText: 'Üye Ol',
                loginEmailLabel: 'E-posta',
                loginPasswordLabel: 'Şifre',
                forgotPasswordLink: 'Şifremi unuttum?',
                loginSubmitBtn: 'Giriş Yap',
                signupNameLabel: 'Ad Soyad',
                signupEmailLabel: 'E-posta',
                signupPasswordLabel: 'Şifre',
                signupConfirmLabel: 'Şifre Tekrar',
                signupSubmitBtn: 'Hesap Oluştur',
                googleBtnText: 'Google ile devam et',
                googleSignupBtnText: 'Google ile üye ol',
                orText: 'veya',
                orText2: 'veya'
            }
        };

        let currentLang = 'en';
        let map, userMarker, organizations = [], createMode = false, selectedLocation = null;
        let currentUser = null;

        // EmailJS Configuration
        // TODO: emailjs.com'dan aldığınız bilgilerle değiştirin
        const EMAILJS_PUBLIC_KEY = 'YOUR_PUBLIC_KEY'; // emailjs.com'dan alacaksınız
        const EMAILJS_SERVICE_ID = 'YOUR_SERVICE_ID'; // Gmail service ID
        const EMAILJS_TEMPLATE_ID = 'YOUR_TEMPLATE_ID'; // Template ID

        // EmailJS başlat
        (function() {
            emailjs.init(EMAILJS_PUBLIC_KEY);
        })();

        // Email gönderme fonksiyonu
        function sendWelcomeEmail(userEmail, userName) {
            const templateParams = {
                to_email: userEmail,
                to_name: userName,
                message: currentLang === 'tr' 
                    ? 'Organize.Quest topluluğuna hoş geldiniz! Artık organizasyonlar oluşturabilir ve etkinliklere katılabilirsiniz.'
                    : 'Welcome to Organize.Quest! You can now create organizations and join events.'
            };

            emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams)
                .then(function(response) {
                    console.log('Email sent successfully!', response.status, response.text);
                }, function(error) {
                    console.log('Email failed...', error);
                });
        }

        function changeLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn' + lang.toUpperCase()).classList.add('active');
            
            Object.keys(translations[lang]).forEach(key => {
                const el = document.getElementById(key);
                if (el) el.textContent = translations[lang][key];
            });
        }

        function switchLoginTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const loginTabBtn = document.getElementById('loginTabBtn');
            const signupTabBtn = document.getElementById('signupTabBtn');

            if (tab === 'login') {
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
                loginTabBtn.style.borderBottom = '3px solid var(--primary)';
                loginTabBtn.style.color = 'var(--primary)';
                signupTabBtn.style.borderBottom = '3px solid transparent';
                signupTabBtn.style.color = 'var(--gray)';
            } else {
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
                signupTabBtn.style.borderBottom = '3px solid var(--primary)';
                signupTabBtn.style.color = 'var(--primary)';
                loginTabBtn.style.borderBottom = '3px solid transparent';
                loginTabBtn.style.color = 'var(--gray)';
            }
        }

        function openLoginModal() {
            document.getElementById('loginModal').classList.add('show');
            switchLoginTab('login');
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('show');
            document.getElementById('loginForm').reset();
            document.getElementById('signupForm').reset();
        }

        function changeLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn' + lang.toUpperCase()).classList.add('active');
            
            Object.keys(translations[lang]).forEach(key => {
                const el = document.getElementById(key);
                if (el) el.textContent = translations[lang][key];
            });
        }

        function openMapApp() {
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('mapApp').classList.add('active');
            if (!map) setTimeout(initMap, 100);
        }

        function closeMapApp() {
            document.getElementById('mapApp').classList.remove('active');
            document.getElementById('landingPage').classList.remove('hidden');
        }

        function initMap() {
            map = L.map('map').setView([40.7128, -74.0060], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            
            map.on('click', function(e) {
                if (createMode) {
                    selectedLocation = e.latlng;
                    // Konum bilgisini input'a yaz
                    document.getElementById('orgLocationDisplay').value = 
                        `Lat: ${e.latlng.lat.toFixed(4)}, Lng: ${e.latlng.lng.toFixed(4)}`;
                    document.getElementById('createModal').classList.add('show');
                    createMode = false;
                    map.getContainer().style.cursor = 'grab';
                }
            });

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(pos) {
                    const loc = [pos.coords.latitude, pos.coords.longitude];
                    map.setView(loc, 14);
                    userMarker = L.marker(loc).addTo(map).bindPopup('📍 Your Location').openPopup();
                });
            }
        }

        function toggleCreateMode() {
            // Önce kullanıcı girişi kontrolü
            if (!currentUser) {
                alert(currentLang === 'tr' ? 
                    'Organizasyon oluşturmak için lütfen giriş yapın!' : 
                    'Please log in to create an organization!');
                openLoginModal();
                return;
            }

            createMode = !createMode;
            map.getContainer().style.cursor = createMode ? 'crosshair' : 'grab';
            if (createMode) {
                alert(currentLang === 'tr' ? 
                    'Haritaya tıklayarak konum seçin' : 
                    'Click on the map to select a location');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('btnEN').addEventListener('click', () => changeLanguage('en'));
            document.getElementById('btnTR').addEventListener('click', () => changeLanguage('tr'));
            document.getElementById('openMapBtn').addEventListener('click', openMapApp);
            document.getElementById('heroMapBtn').addEventListener('click', openMapApp);
            document.getElementById('closeMapBtn').addEventListener('click', closeMapApp);
            document.getElementById('findLocationBtn').addEventListener('click', initMap);
            document.getElementById('createOrgBtn').addEventListener('click', toggleCreateMode);
            document.getElementById('modalCloseBtn').addEventListener('click', () => {
                document.getElementById('createModal').classList.remove('show');
            });

            // Login modal events
            document.getElementById('loginModalClose').addEventListener('click', closeLoginModal);
            document.getElementById('loginTabBtn').addEventListener('click', () => switchLoginTab('login'));
            document.getElementById('signupTabBtn').addEventListener('click', () => switchLoginTab('signup'));

            // Google login buttons
            document.getElementById('googleLoginBtn').addEventListener('click', function() {
                // Google OAuth simülasyonu
                currentUser = { email: 'user@gmail.com', name: 'Google User', provider: 'google' };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                alert(currentLang === 'tr' ? 'Google ile başarıyla giriş yaptınız!' : 'Successfully signed in with Google!');
                closeLoginModal();
                document.getElementById('loginBtn').textContent = currentLang === 'tr' ? '👤 Hesabım' : '👤 My Account';
            });

            document.getElementById('googleSignupBtn').addEventListener('click', function() {
                // Google OAuth simülasyonu
                currentUser = { email: 'user@gmail.com', name: 'Google User', provider: 'google' };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                alert(currentLang === 'tr' ? 'Google ile hesabınız oluşturuldu!' : 'Account created with Google!');
                closeLoginModal();
                document.getElementById('loginBtn').textContent = currentLang === 'tr' ? '👤 Hesabım' : '👤 My Account';
            });

            // Login form submit
            document.getElementById('loginForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                // Supabase ile giriş
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) {
                    alert('Error: ' + error.message);
                    return;
                }

                // User tablosundan profil bilgilerini al
                const { data: profile, error: profileError } = await supabase
                    .from('users')
                    .select('*')
                    .eq('id', data.user.id)
                    .single();

                currentUser = profile || { id: data.user.id, email: email, name: 'User' };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                alert(currentLang === 'tr' ? 'Başarıyla giriş yaptınız!' : 'Successfully logged in!');
                closeLoginModal();
                document.getElementById('loginBtn').textContent = currentLang === 'tr' ? '👤 Hesabım' : '👤 My Account';
            });

            // Signup form submit
            document.getElementById('signupForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const name = document.getElementById('signupName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const confirm = document.getElementById('signupConfirm').value;

                if (password !== confirm) {
                    alert(currentLang === 'tr' ? 'Şifreler eşleşmiyor!' : 'Passwords do not match!');
                    return;
                }

                // Supabase ile kayıt
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: { name: name }
                    }
                });

                if (error) {
                    alert('Error: ' + error.message);
                    return;
                }

                // User tablosuna profil bilgilerini ekle
                const { error: profileError } = await supabase
                    .from('users')
                    .insert([{ 
                        id: data.user.id,
                        email: email, 
                        name: name 
                    }]);

                currentUser = { id: data.user.id, email: email, name: name };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Hoş geldin emaili gönder
                sendWelcomeEmail(email, name);
                
                alert(currentLang === 'tr' ? 
                    'Hesabınız başarıyla oluşturuldu! Email adresinizi doğrulayın.' : 
                    'Account created! Please verify your email.');
                closeLoginModal();
                document.getElementById('loginBtn').textContent = currentLang === 'tr' ? '👤 Hesabım' : '👤 My Account';
            });

            // Login butonu - giriş yapılmışsa profile.html'e yönlendir
            document.getElementById('loginBtn').addEventListener('click', function() {
                if (currentUser) {
                    // Kullanıcı bilgisini localStorage'a kaydet (profile.html'de okuyabilmek için)
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    window.location.href = 'profile.html';
                } else {
                    openLoginModal();
                }
            });

            // Sayfa yüklendiğinde kullanıcıyı kontrol et
            window.addEventListener('DOMContentLoaded', function() {
                const savedUser = JSON.parse(localStorage.getItem('currentUser'));
                if (savedUser) {
                    currentUser = savedUser;
                    document.getElementById('loginBtn').textContent = currentLang === 'tr' ? '👤 Hesabım' : '👤 My Account';
                }
            });

            document.getElementById('createOrgForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                if (selectedLocation) {
                    const orgData = {
                        name: document.getElementById('orgName').value,
                        category: document.getElementById('orgCategory').value,
                        description: document.getElementById('orgDescription').value,
                        event_date: document.getElementById('orgDateTime').value || null,
                        age_restriction: document.getElementById('orgAgeRestriction').value,
                        capacity: document.getElementById('orgCapacity').value || null,
                        contact_email: document.getElementById('orgContact').value,
                        latitude: selectedLocation.lat,
                        longitude: selectedLocation.lng,
                        created_by: currentUser.id
                    };

                    // Supabase'e kaydet
                    const { data, error } = await supabase
                        .from('organizations')
                        .insert([orgData])
                        .select();

                    if (error) {
                        alert('Error: ' + error.message);
                        return;
                    }

                    const org = data[0];
                    organizations.push(org);
                    
                    // Haritaya marker ekle
                    const marker = L.marker([org.latitude, org.longitude])
                        .addTo(map)
                        .bindPopup(`
                            <div style="min-width: 250px;">
                                <h3 style="color: var(--primary); margin-bottom: 10px;">${org.name}</h3>
                                <p><strong>Category:</strong> ${org.category}</p>
                                ${org.event_date ? `<p><strong>📅 Date:</strong> ${new Date(org.event_date).toLocaleString()}</p>` : ''}
                                ${org.age_restriction !== 'all' ? `<p><strong>🔞 Age:</strong> ${org.age_restriction}</p>` : ''}
                                ${org.capacity ? `<p><strong>👥 Max:</strong> ${org.capacity} people</p>` : ''}
                                ${org.description ? `<p>${org.description}</p>` : ''}
                                ${org.contact_email ? `<p><strong>📧 Contact:</strong> ${org.contact_email}</p>` : ''}
                            </div>
                        `);
                    
                    document.getElementById('createModal').classList.remove('show');
                    this.reset();
                    document.getElementById('orgLocationDisplay').value = '';
                    selectedLocation = null;
                    alert(currentLang === 'tr' ? 'Organizasyon başarıyla oluşturuldu!' : 'Organization created successfully!');
                }
            });
        });
    </script>
</body>
</html>
